@page "/profile"
@inherits ProfileBase
@layout MainLayout

<div class="profile_container row m-0" style="height: calc(100vh - 56px) !important;">

    <div class="profile_container_left col-lg-4 col-xxl-3 container-fluid py-0 px-5" style="border-right: 1px solid #d6d5d5;">

        <div class="text-center py-5" style="height: 300px; background-color: white;">
            <img src="@(User.ProfileImage != null ? User.ProfileImage : "/img/default.png")" class="rounded img-fluid h-100" alt="User Profile Picture">
            <div class="upload-profile-image" style="margin-top: -28px;">
                <InputFile id="fileInput" OnChange="UploadFiles" hidden accept=".jpg, .jpeg, .png" />
                <MudIconButton HtmlTag="label" Icon="@Icons.Filled.PhotoCamera" for="fileInput" Style="background-color: lightgreen;">
                </MudIconButton>
            </div>
        </div>
        <hr />
        <div class="px-5">
            <div class="rating_container" style="display: flex; flex-direction: column; align-items: center;">
                <p class="m-0" style="font-size: 24px; font-family: 'Dancing Script', cursive;">Rating</p>
                <MudRating ReadOnly="true" SelectedValue="4" Size="Size.Large" />
                <h3>4.2</h3>
            </div>
            <div class="other_info mx-5 mt-5 px-5" style="font-size: 18px;">
                <p>Orders: <b>92</b></p>
                <p>Products: <b>12</b></p>
            </div>
        </div>
        <hr />
        <div style="font-size: 20px; text-align: center;">
            <p style="font-family: 'Dancing Script', cursive;">Member since <b style="font-family: 'Dancing Script', cursive;">2016</b></p>
        </div>

    </div>

    <div class="profile_container_right col-lg-8 col-xxl-9 p-0">

        <div class="profile_header pl-5" style="height: 80px;display: flex;align-items: center;">
            <h3 class="ml-5 mb-0 pl-5" style="font-size: 32px;font-weight: 400;">Profile</h3>
        </div>

        <MudTabs Style="z-index: 0;" Centered="true" Rounded="true" ApplyEffectsToContainer="true" PanelClass="pa-6">
            <MudTabPanel Text="Profile details">
                <MudText>Profile details</MudText>
                <MudSimpleTable Style="overflow-x: auto;">
                    <thead>
                        <tr>
                            @foreach (var h in headings)
                            {
                                <th>@h</th>
                            }
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var row in rows)
                        {
                            <tr>
                                @foreach (var x in row.Split())
                                {
                                    <td>@x</td>
                                }
                            </tr>
                        }
                    </tbody>
                </MudSimpleTable>
            </MudTabPanel>

            <MudTabPanel Text="Contact details">
                <MudText>Contact details</MudText>

                <InputFile OnChange="OnInputFileChanged" style="margin-bottom: 1rem;" class="white-text"></InputFile>

            </MudTabPanel>
        </MudTabs>


    </div>

</div>

@code
{
    private void UploadFiles(InputFileChangeEventArgs e)
    {
        var entries = e.GetMultipleFiles();
        //Do your validations here
        Snackbar.Configuration.PositionClass = Defaults.Classes.Position.TopCenter;
        Snackbar.Add($"Files with {entries.FirstOrDefault().Size} bytes size are not allowed", Severity.Error);
        Snackbar.Add($"Files starting with letter {entries.FirstOrDefault().Name.Substring(0, 1)} are not recommended", Severity.Warning);
        Snackbar.Add($"This file has the extension {entries.FirstOrDefault().Name.Split(".").Last()}", Severity.Info);

        //TODO upload the files to the server
    }

    string[] headings = { "ID", "Name", "Email", "Gender", "IP Address" };
    string[] rows = {
        @"1 Krishna kpartner0@usatoday.com Male 28.25.250.202",
        @"2 Webb wstitle1@ning.com Male 237.168.134.114",
        @"3 Nathanil nneal2@cyberchimps.com Male 92.6.0.175",
        @"4 Adara alockwood3@patch.com Female 182.174.217.152",
        @"5 Cecilius cchaplin4@shinystat.com Male 195.124.144.18",
        @"6 Cicely cemerine9@soup.io Female 138.94.191.43",
    };
}